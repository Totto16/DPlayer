!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("ass",[],t):"object"==typeof exports?exports.ass=t():e.ass=t()}(self,(function(){return(()=>{var e={4915:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});const a=r.p+"ass/subtitles-octopus-worker-legacy.data"},6290:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});const a=r.p+"ass/subtitles-octopus-worker-legacy.js"},3864:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});const a=r.p+"ass/subtitles-octopus-worker.data"},3115:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});const a=r.p+"ass/subtitles-octopus-worker.js"},8016:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});const a=r.p+"ass/subtitles-octopus-worker.wasm"},8735:(e,t)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}"function"==typeof SubtitlesOctopusOnLoad&&SubtitlesOctopusOnLoad(),e.exports&&(e.exports=function(e){var t=!1;try{if("object"===("undefined"==typeof WebAssembly?"undefined":r(WebAssembly))&&"function"==typeof WebAssembly.instantiate){var a=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));a instanceof WebAssembly.Module&&(t=new WebAssembly.Instance(a)instanceof WebAssembly.Instance)}}catch(e){}console.log("WebAssembly support detected: "+(t?"yes":"no"));var o=this;function n(){var e=o.renderFramesData,t=performance.now();o.ctx.clearRect(0,0,o.canvas.width,o.canvas.height);for(var r=0;r<e.canvases.length;r++){var a=e.canvases[r];o.bufferCanvas.width=a.w,o.bufferCanvas.height=a.h;var n=new Uint8ClampedArray(a.buffer);if(o.hasAlphaBug)for(var s=3;s<n.length;s+=4)n[s]=n[s]>=1?n[s]:1;var i=new ImageData(n,a.w,a.h);o.bufferCanvasCtx.putImageData(i,0,0),o.ctx.drawImage(o.bufferCanvas,a.x,a.y)}if(o.debug){var c=Math.round(performance.now()-t),d=e.blendTime;void 0!==d?console.log("render: "+Math.round(e.spentTime-d)+" ms, blend: "+Math.round(d)+" ms, draw: "+c+" ms; TOTAL="+Math.round(e.spentTime+c)+" ms"):console.log(Math.round(e.spentTime)+" ms (+ "+c+" ms draw)"),o.renderStart=performance.now()}}function s(){var e=o.renderFramesData,t=performance.now();o.ctx.clearRect(0,0,o.canvas.width,o.canvas.height);for(var r=0;r<e.bitmaps.length;r++){var a=e.bitmaps[r];o.ctx.drawImage(a.bitmap,a.x,a.y)}if(o.debug){var n=Math.round(performance.now()-t);console.log(e.bitmaps.length+" bitmaps, libass: "+Math.round(e.libassTime)+"ms, decode: "+Math.round(e.decodeTime)+"ms, draw: "+n+"ms"),o.renderStart=performance.now()}}o.canvas=e.canvas,o.renderMode=e.lossyRender?"fast":e.blendRender?"blend":"normal",o.libassMemoryLimit=e.libassMemoryLimit||0,o.libassGlyphLimit=e.libassGlyphLimit||0,o.targetFps=e.targetFps||void 0,o.isOurCanvas=!1,o.video=e.video,o.canvasParent=null,o.fonts=e.fonts||[],o.availableFonts=e.availableFonts||[],o.onReadyEvent=e.onReady,o.workerUrl=t?e.workerUrl||"subtitles-octopus-worker.js":e.legacyWorkerUrl||"subtitles-octopus-worker-legacy.js",o.subUrl=e.subUrl,o.subContent=e.subContent||null,o.onErrorEvent=e.onError,o.debug=e.debug||!1,o.lastRenderTime=0,o.pixelRatio=window.devicePixelRatio||1,o.timeOffset=e.timeOffset||0,o.hasAlphaBug=!1,function(){if("function"==typeof ImageData.prototype.constructor)try{return void new window.ImageData(new Uint8ClampedArray([0,0,0,0]),1,1)}catch(e){console.log("detected that ImageData is not constructable despite browser saying so")}var e=document.createElement("canvas").getContext("2d");window.ImageData=function(){var t=0;if(arguments[0]instanceof Uint8ClampedArray)var r=arguments[t++];var a=arguments[t++],o=arguments[t],n=e.createImageData(a,o);return r&&n.data.set(r),n}}(),o.workerError=function(e){if(console.error("Worker error: ",e),o.onErrorEvent&&o.onErrorEvent(e),!o.debug)throw o.dispose(),new Error("Worker error: "+e)},o.init=function(){window.Worker?(o.worker||(o.worker=new Worker(o.workerUrl),o.worker.onmessage=o.onWorkerMessage,o.worker.onerror=o.workerError),o.workerActive=!1,o.createCanvas(),o.setVideo(e.video),o.setSubUrl(e.subUrl),o.worker.postMessage({target:"worker-init",width:o.canvas.width,height:o.canvas.height,URL:document.URL,currentScript:o.workerUrl,preMain:!0,renderMode:o.renderMode,subUrl:o.subUrl,subContent:o.subContent,fonts:o.fonts,availableFonts:o.availableFonts,debug:o.debug,targetFps:o.targetFps,libassMemoryLimit:o.libassMemoryLimit,libassGlyphLimit:o.libassGlyphLimit})):o.workerError("worker not supported")},o.createCanvas=function(){o.canvas||(o.video?(o.isOurCanvas=!0,o.canvas=document.createElement("canvas"),o.canvas.className="libassjs-canvas",o.canvas.style.display="none",o.canvasParent=document.createElement("div"),o.canvasParent.className="libassjs-canvas-parent",o.canvasParent.appendChild(o.canvas),o.video.nextSibling?o.video.parentNode.insertBefore(o.canvasParent,o.video.nextSibling):o.video.parentNode.appendChild(o.canvasParent)):o.canvas||o.workerError("Don't know where to render: you should give video or canvas in options.")),o.ctx=o.canvas.getContext("2d"),o.bufferCanvas=document.createElement("canvas"),o.bufferCanvasCtx=o.bufferCanvas.getContext("2d"),o.bufferCanvas.width=1,o.bufferCanvas.height=1;var e=new Uint8ClampedArray([0,255,0,0]),t=new ImageData(e,1,1);o.bufferCanvasCtx.clearRect(0,0,1,1),o.ctx.clearRect(0,0,1,1);var r=o.ctx.getImageData(0,0,1,1).data;o.bufferCanvasCtx.putImageData(t,0,0),o.ctx.drawImage(o.bufferCanvas,0,0);var a=o.ctx.getImageData(0,0,1,1).data;o.hasAlphaBug=r[1]!=a[1],o.hasAlphaBug&&console.log("Detected a browser having issue with transparent pixels, applying workaround")},o.setVideo=function(e){if(o.video=e,o.video){var t=function(){o.setCurrentTime(e.currentTime+o.timeOffset)};o.video.addEventListener("timeupdate",t,!1),o.video.addEventListener("playing",(function(){o.setIsPaused(!1,e.currentTime+o.timeOffset)}),!1),o.video.addEventListener("pause",(function(){o.setIsPaused(!0,e.currentTime+o.timeOffset)}),!1),o.video.addEventListener("seeking",(function(){o.video.removeEventListener("timeupdate",t)}),!1),o.video.addEventListener("seeked",(function(){o.video.addEventListener("timeupdate",t,!1),o.setCurrentTime(e.currentTime+o.timeOffset)}),!1),o.video.addEventListener("ratechange",(function(){o.setRate(e.playbackRate)}),!1),o.video.addEventListener("waiting",(function(){o.setIsPaused(!0,e.currentTime+o.timeOffset)}),!1),document.addEventListener("fullscreenchange",o.resizeWithTimeout,!1),document.addEventListener("mozfullscreenchange",o.resizeWithTimeout,!1),document.addEventListener("webkitfullscreenchange",o.resizeWithTimeout,!1),document.addEventListener("msfullscreenchange",o.resizeWithTimeout,!1),window.addEventListener("resize",o.resizeWithTimeout,!1),"undefined"!=typeof ResizeObserver&&(o.ro=new ResizeObserver(o.resizeWithTimeout),o.ro.observe(o.video)),o.video.videoWidth>0?o.resize():o.video.addEventListener("loadedmetadata",(function e(t){t.target.removeEventListener(t.type,e),o.resize()}),!1)}},o.getVideoPosition=function(){var e=o.video.videoWidth/o.video.videoHeight,t=o.video.offsetWidth,r=o.video.offsetHeight,a=t,n=r;return t/r>e?a=Math.floor(r*e):n=Math.floor(t/e),{width:a,height:n,x:(t-a)/2,y:(r-n)/2}},o.setSubUrl=function(e){o.subUrl=e},o.renderFrameData=null,o.workerActive=!1,o.frameId=0,o.onWorkerMessage=function(e){o.workerActive||(o.workerActive=!0,o.onReadyEvent&&o.onReadyEvent());var t=e.data;switch(t.target){case"stdout":console.log(t.content);break;case"console-log":console.log.apply(console,JSON.parse(t.content));break;case"console-debug":console.debug.apply(console,JSON.parse(t.content));break;case"console-info":console.info.apply(console,JSON.parse(t.content));break;case"console-warn":console.warn.apply(console,JSON.parse(t.content));break;case"console-error":console.error.apply(console,JSON.parse(t.content));break;case"stderr":console.error(t.content);break;case"window":window[t.method]();break;case"canvas":switch(t.op){case"getContext":o.ctx=o.canvas.getContext(t.type,t.attributes);break;case"resize":o.resize(t.width,t.height);break;case"renderCanvas":o.lastRenderTime<t.time&&(o.lastRenderTime=t.time,o.renderFramesData=t,window.requestAnimationFrame(n));break;case"renderFastCanvas":o.lastRenderTime<t.time&&(o.lastRenderTime=t.time,o.renderFramesData=t,window.requestAnimationFrame(s));break;case"setObjectProperty":o.canvas[t.object][t.property]=t.value;break;default:throw"eh?"}break;case"tick":o.frameId=t.id,o.worker.postMessage({target:"tock",id:o.frameId});break;case"custom":if(!o.onCustomMessage)throw"Custom message received but client onCustomMessage not implemented.";o.onCustomMessage(e);break;case"setimmediate":o.worker.postMessage({target:"setimmediate"});break;case"get-events":console.log(t.target),console.log(t.events);break;case"get-styles":console.log(t.target),console.log(t.styles);break;case"ready":break;default:throw"what? "+t.target}},o.resize=function(e,t,r,a){var n=null;if(r=r||0,a=a||0,(!e||!t)&&o.video){e=(n=o.getVideoPosition()).width*o.pixelRatio,t=n.height*o.pixelRatio;var s=o.canvasParent.getBoundingClientRect().top-o.video.getBoundingClientRect().top;r=n.y-s,a=n.x}e&&t?o.canvas.width==e&&o.canvas.height==t&&o.canvas.style.top==r&&o.canvas.style.left==a||(o.canvas.width=e,o.canvas.height=t,null!=n&&(o.canvasParent.style.position="relative",o.canvas.style.display="block",o.canvas.style.position="absolute",o.canvas.style.width=n.width+"px",o.canvas.style.height=n.height+"px",o.canvas.style.top=r+"px",o.canvas.style.left=a+"px",o.canvas.style.pointerEvents="none"),o.worker.postMessage({target:"canvas",width:o.canvas.width,height:o.canvas.height})):o.video||console.error("width or height is 0. You should specify width & height for resize.")},o.resizeWithTimeout=function(){o.resize(),setTimeout(o.resize,100)},o.runBenchmark=function(){o.worker.postMessage({target:"runBenchmark"})},o.customMessage=function(e,t){t=t||{},o.worker.postMessage({target:"custom",userData:e,preMain:t.preMain})},o.setCurrentTime=function(e){o.worker.postMessage({target:"video",currentTime:e})},o.setTrackByUrl=function(e){o.worker.postMessage({target:"set-track-by-url",url:e})},o.setTrack=function(e){o.worker.postMessage({target:"set-track",content:e})},o.freeTrack=function(e){o.worker.postMessage({target:"free-track"})},o.render=o.setCurrentTime,o.setIsPaused=function(e,t){o.worker.postMessage({target:"video",isPaused:e,currentTime:t})},o.setRate=function(e){o.worker.postMessage({target:"video",rate:e})},o.dispose=function(){o.worker.postMessage({target:"destroy"}),o.worker.terminate(),o.workerActive=!1,o.video&&o.video.parentNode.removeChild(o.canvasParent)},o.createEvent=function(e){o.worker.postMessage({target:"create-event",event:e})},o.getEvents=function(){o.worker.postMessage({target:"get-events"})},o.setEvent=function(e,t){o.worker.postMessage({target:"set-event",event:e,index:t})},o.removeEvent=function(e){o.worker.postMessage({target:"remove-event",index:e})},o.createStyle=function(e){o.worker.postMessage({target:"create-style",style:e})},o.getStyles=function(){o.worker.postMessage({target:"get-styles"})},o.setStyle=function(e,t){o.worker.postMessage({target:"set-style",style:e,index:t})},o.removeStyle=function(e){o.worker.postMessage({target:"remove-style",index:e})},o.init()})}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/";var a={};return(()=>{"use strict";r.d(a,{default:()=>i});var e=r(8735),t=r.n(e);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const i=function(e,a,o){if(t()){var s={fonts:[],workerUrl:"subtitles-octopus-worker.js",legacyWorkerUrl:"subtitles-octopus-worker-legacy.js",onReady:o,onError:function(e){console.log(e)},debug:!0,lossyRender:!0};return r(3115),r(3864),r(8016),r(6290),r(4915),e=n(n({},s),e),a.options.pluginOptions.ass=e,new(t())(e)}console.error("SubtitlesOctopus is not defined, fatal Error!")}})(),a.default})()}));
//# sourceMappingURL=ass.min.js.map